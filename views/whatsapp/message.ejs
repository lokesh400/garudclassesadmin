<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>WhatsApp Chat</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="h-screen w-screen overflow-hidden bg-gray-100">

<div class="flex h-full w-full">

  <!-- LEFT USER LIST -->
  <aside class="w-80 bg-[#075e54] text-white flex flex-col">
    
    <!-- Header -->
    <div class="p-4 font-semibold text-lg border-b border-[#0b806f]">
      Chats
    </div>

    <!-- Users -->
    <ul id="userList" class="flex-1 overflow-y-auto">
      <% if (users && users.length) { %>
        <% users.forEach(user => { %>
          <li
            onclick="selectUser('<%= user.number %>', '<%= user.name %>')"
            class="flex items-center gap-3 p-4 cursor-pointer hover:bg-[#0b806f] transition border-b border-[#0b806f]"
          >

            <!-- Avatar -->
            <div class="w-10 h-10 rounded-full bg-[#128c7e] flex items-center justify-center font-bold">
              <%= user.name.charAt(0).toUpperCase() %>
            </div>

            <!-- Name -->
            <div class="flex-1">
              <div class="font-medium leading-tight">
                <%= user.name %>
              </div>
              <div class="text-xs opacity-80">
                <%= user.batch?.name || "No Batch" %>
              </div>
            </div>

          </li>
        <% }) %>
      <% } else { %>
        <li class="p-4 text-sm opacity-80">No users available</li>
      <% } %>
    </ul>
  </aside>

  <!-- RIGHT CHAT -->
  <main class="flex-1 flex flex-col bg-[#ece5dd]">

    <!-- CHAT HEADER -->
    <header
      id="chatHeader"
      class="h-16 px-6 flex items-center bg-[#075e54] text-white font-semibold shadow"
    >
      Select a chat
    </header>

    <!-- MESSAGES -->
    <section
      id="chatBox"
      class="flex-1 p-4 overflow-y-auto space-y-2 bg-[url('https://i.imgur.com/6Iej2c3.png')] bg-repeat"
    >
      <!-- Messages will appear here -->
    </section>

    <!-- INPUT -->
    <footer class="h-16 bg-white px-4 flex items-center gap-3 border-t">
      <input
        id="message"
        type="text"
        placeholder="Type a message"
        class="flex-1 rounded-full px-4 py-2 border focus:outline-none focus:ring-2 focus:ring-[#075e54]"
      />
      <button
        onclick="sendMessage()"
        class="bg-[#075e54] hover:bg-[#0b806f] text-white px-5 py-2 rounded-full transition"
      >
        Send
      </button>
    </footer>

  </main>
</div>

<script src="/socket.io/socket.io.js"></script>

<script>
  let selectedUser = null;

  function selectUser(id, name) {
    selectedUser = id;
    document.getElementById("chatHeader").innerText = name;
    document.getElementById("chatBox").innerHTML = "";
  }

  function sendMessage() {
    const input = document.getElementById("message");
    const msg = input.value.trim();
    if (!msg || !selectedUser) return;

    // UI preview (replace with socket emit)
    const bubble = document.createElement("div");
    bubble.className =
      "ml-auto max-w-xs bg-[#dcf8c6] px-4 py-2 rounded-lg shadow text-sm";
    bubble.innerText = msg;

    document.getElementById("chatBox").appendChild(bubble);
    input.value = "";
  }
</script>

</body>
</html>
