<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title || "Admin Panel" %></title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body class="bg-gray-100 flex h-screen">

  <!-- Sidebar -->
  <aside id="sidebar"
    class="w-64 bg-gray-900 text-white flex flex-col fixed inset-y-0 left-0 transform 
           -translate-x-full transition-transform duration-300 z-50">

    <div class="p-5 text-center font-bold text-xl border-b border-gray-800">
      Garud Classes
    </div>

    <nav class="flex-1 p-3 space-y-2">
      <% if( currUser && currUser.role === 'superadmin'  ) {%>
        <a href="/admin" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
          <i class="fas fa-chart-line"></i> Dashboard
        </a>
        <a href="/api/students/all" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
          <i class="fas fa-user-graduate"></i> All Students
        </a>
        <a href="/teachers/all" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
          <i class="fas fa-chalkboard-teacher"></i> Faculty
        </a>
      <%}%>  

      <% if(currUser && (currUser.role === 'superadmin' || currUser.role === 'admin')) { %>
        <a href="/api/batches/" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
          <i class="fas fa-layer-group"></i> All Batches
        </a>
      <%}%>

      <% if(currUser && currUser.role === 'superadmin') { %> 
        <a href="/fees" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
          <i class="fas fa-money-bill"></i> Fees
        </a>
      <%}%> 

      <a href="/forms/list" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
        <i class="fas fa-file"></i> Forms
      </a>

      <% if(currUser && (currUser.role === 'superadmin' || currUser.role === 'admin')) { %> 
        <a href="/forms/create" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
          <i class="fas fa-plus"></i> New Form
        </a>
      <% } %>
  
      <% if(currUser && currUser.role === 'superadmin') { %> 
        <a href="/whatsapp" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
          <i class="fas fa-comment"></i> Whatsapp Status
        </a>
        <a href="/send" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
          <i class="fas fa-paper-plane"></i> Send Message
        </a>
      <% } %>

      <a href="/queries" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
        <i class="fas fa-question-circle"></i> All Queries
      </a>

      <a href="/queries/new" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
        <i class="fas fa-plus-circle"></i> Add New Query
      </a>

    </nav>

    <div class="p-3 border-t border-gray-700">
      <a href="/logout" class="flex items-center gap-3 p-2 rounded-md hover:bg-gray-800">
        <i class="fas fa-sign-out-alt"></i> Logout
      </a>
    </div>

  </aside>


  <!-- Main Content -->
  <main class="flex-1 p-6 overflow-y-auto bg-white">

    <!-- Top bar -->
    <header class="flex justify-between items-center mb-6">

      <!-- Hamburger Button -->
      <button id="menuBtn" class="text-gray-700 text-2xl">
        <i class="fas fa-bars"></i>
      </button>

      <h1 class="text-2xl font-semibold">
        <%= pageTitle || "Dashboard" %>
      </h1>

      <div class="flex items-center space-x-4">
        <span class="text-gray-700 font-medium hidden sm:block">
          Welcome, <%= currUser?.name || "Admin" %>
        </span>
        <img src="https://ui-avatars.com/api/?name=Admin"
             alt="Admin"
             class="w-8 h-8 rounded-full border">
      </div>
    </header>

    <!-- Dynamic Content -->
    <%- body %>

  </main>


  <!-- Background Overlay -->
  <div id="overlay" class="fixed inset-0 bg-black bg-opacity-40 hidden z-40"></div>

<script>
  const sidebar = document.getElementById("sidebar");
  const overlay = document.getElementById("overlay");
  const menuBtn = document.getElementById("menuBtn");

  menuBtn?.addEventListener("click", () => {
    sidebar.classList.toggle("-translate-x-full");
    overlay.classList.toggle("hidden");
  });

  overlay?.addEventListener("click", () => {
    sidebar.classList.add("-translate-x-full");
    overlay.classList.add("hidden");
  });
</script>

</body>
</html>
